version: 2

models:
  - name: polymarket_polygon_market_categories
    meta:
      blockchain: polygon
      sector: prediction_markets
      project: polymarket
      contributors: tomfutago
    config:
      tags: ['polygon','prediction_markets','polymarket','markets']
    description: "Polymarket: market categories"
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - market_id
    columns:
      - &block_time
        name: block_time
      - &block_number
        name: block_number
      - &market_id
        name: market_id
      - &market
        name: market
      - &market_description
        name: market_description
      - &oracle
        name: oracle
      - &fee_bips
        name: fee_bips
      - &evt_index
        name: evt_index
      - &tx_hash
        name: tx_hash

  - name: polymarket_polygon_markets
    meta:
      blockchain: polygon
      sector: prediction_markets
      project: polymarket
      contributors: tomfutago
    config:
      tags: ['polygon','prediction_markets','polymarket','markets']
    description: "Polymarket: markets"
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - question_id
    columns:
      - *block_time
      - *block_number
      - &source
        name: source
      - *market_id
      - &question_id
        name: question_id
      - &question
        name: question
      - &question_description
        name: question_description
      - &reward
        name: reward
      - &reward_token
        name: reward_token
      - *evt_index
      - *tx_hash

  - name: polymarket_polygon_market_outcomes
    meta:
      blockchain: polygon
      sector: prediction_markets
      project: polymarket
      contributors: tomfutago
    config:
      tags: ['polygon','prediction_markets','polymarket','markets']
    description: "Polymarket: market outcomes"
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - question_id
    columns:
      - *block_time
      - *block_number
      - *source
      - *question_id
      - &outcome
        name: outcome
      - *evt_index
      - *tx_hash

  - name: polymarket_polygon_base_market_conditions
    meta:
      blockchain: polygon
      sector: prediction_markets
      project: polymarket
      contributors: tomfutago
    config:
      tags: ['polygon','prediction_markets','polymarket','markets']
    description: "Polymarket: market conditions (helper table)"
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - condition_id
    columns:
      - *block_time
      - *block_number
      - *market_id
      - *question_id
      - *question
      - &condition_id
        name: condition_id
      - &condition_token
        name: condition_token
      - &condition_status
        name: condition_status
      - &keyword
        name: keyword
      - &condition
        name: condition
      - &outcome_slot_count
        name: outcome_slot_count
      - *oracle
      - *evt_index
      - *tx_hash

  - name: polymarket_polygon_base_ctf_tokens
    meta:
      blockchain: polygon
      sector: prediction_markets
      project: polymarket
      contributors: tomfutago
    config:
      tags: ['polygon','prediction_markets','polymarket','markets']
    description: "Polymarket: CTF tokens (helper table)"
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - condition_id
            - token0
            - token1
    columns:
      - *block_time
      - *block_number
      - *condition_id
      - &token0
        name: token0
      - &token1
        name: token1
      - *evt_index
      - *tx_hash

  - name: polymarket_polygon_market_conditions
    meta:
      blockchain: polygon
      sector: prediction_markets
      project: polymarket
      contributors: tomfutago
    config:
      tags: ['polygon','prediction_markets','polymarket','markets']
    description: "Polymarket: market conditions"
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - question_id
            - condition_id
            - condition_token
    columns:
      - *block_time
      - *block_number
      - *condition_id
      - *question_id
      - *outcome_slot_count
      - *oracle
      - *evt_index
      - *tx_hash

  - name: polymarket_polygon_market_trades
    meta:
      blockchain: polygon
      sector: prediction_markets
      project: polymarket
      contributors: tomfutago
    config:
      tags: ['polygon','prediction_markets','polymarket','markets']
    description: "Polymarket: market trades"
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - block_time
            - asset_id
            - evt_index
            - tx_hash
    columns:
      - *block_time
      - *block_number
      - &action
        name: action
      - *condition_id
      - &asset_id
        name: asset_id
      - &amount
        name: amount
      - &price
        name: price
      - &fee
        name: fee
      - &maker
        name: maker
      - &taker
        name: taker
      - &maker_amount_raw
        name: maker_amount_raw
      - &taker_amount_raw
        name: taker_amount_raw
      - &contract_address
        name: contract_address
      - *evt_index
      - *tx_hash

  - name: polymarket_polygon_capital_actions
    meta:
      blockchain: polygon
      sector: prediction_markets
      project: polymarket
      contributors: tomfutago
    config:
      tags: ['polygon','prediction_markets','polymarket','markets']
    description: "Polymarket: user capital actions"
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - block_time
            - evt_index
            - tx_hash
    columns:
      - *block_time
      - *block_number
      - *action
      - &from_address
        name: from_address
      - &to_address
        name: to_address
      - &symbol
        name: symbol
      - &amount_raw
        name: amount_raw
      - *amount
      - &amount_usd
        name: amount_usd
      - *evt_index
      - *tx_hash
